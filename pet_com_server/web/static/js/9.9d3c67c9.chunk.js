(this.webpackJsonppet_com_web=this.webpackJsonppet_com_web||[]).push([[9],{107:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(62);function r(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(o.a)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,c=function(){};return{s:c,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}},165:function(t,e,n){},166:function(t,e,n){},167:function(t,e,n){},168:function(t,e,n){},198:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return N}));var o=n(52),r=n(1),c=n(8),i=n(9),s=n(11),a=n(10),u=n(0),l=n(50),p=n(65),d=n(87),m=n(49),f=n(69),b=n(66),h=n(17),j=n(71),O=n(55),y=n(120),v=n(107),g=(n(165),function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))).state={isGood:!!t.props.good.includes(t.props.app_user._id),goods:t.props.good.length,isPopup:!1},t.handleCommonClick=function(e){e.stopPropagation(),t.isShowPopup(e)},t.isShowPopup=function(e){var n=t.state.isPopup;t.setState({isPopup:!n})},t.handleGoodClick=function(e){e.stopPropagation();var n=t.props,o=n._id,r=n.app_user,c=t.state.goods;Object(m.k)(r._id,o).then((function(e){console.log("res",e),e.data.good.includes(r._id.toString())?(c--,t.setState({isGood:!1})):(c++,t.setState({isGood:!0})),t.setState({goods:c})}))},t.handleSendClick=function(e){e.stopPropagation();var n={user_id:t.props.app_user._id,text:t.textarea.value,parent:t.props._id};Object(m.i)(n).then((function(n){t.textarea.value="",console.log("res.data",n.data);var o=n.data,r={_id:o._id,createdAt:o.dynamic.content.createdAt,reply_common_user:t.props.send_common_user,send_common_user:o.user,text:o.dynamic.content.text,good:o.dynamic.content.good};t.props.updateCommonList(r),t.isShowPopup(e)}))},t}return Object(i.a)(n,[{key:"render",value:function(){var t=this,e=this.state,n=e.isGood,o=e.goods,c=e.isPopup,i=this.props,s=(i._id,i.createdAt),a=i.reply_common_user,u=i.send_common_user,l=i.text;i.good;return Object(r.jsxs)("div",{className:"ci-ctn margin1-t ".concat(this.props.className),children:[Object(r.jsxs)("div",{className:"flex",children:[Object(r.jsx)(p.a,{className:"margin1-r",size:"mini"}),Object(r.jsxs)("div",{className:"flex",children:[Object(r.jsx)("span",{className:"font3 font-blue",children:u.username}),a&&Object(r.jsx)("span",{className:"font3 margin1-lr",children:" \u56de\u590d "}),a&&Object(r.jsx)("span",{className:"font3 font-blue",children:a.username})]})]}),Object(r.jsx)("div",{className:"ci-ctn-common font25",children:l}),Object(r.jsxs)("div",{className:"ci-ctn-handle font25 flex space-between padding05",children:[Object(r.jsx)("span",{className:"font-deep-gray",children:s}),Object(r.jsxs)("div",{children:[Object(r.jsxs)("span",{onClick:this.handleCommonClick,className:"margin1-r",children:[Object(r.jsx)("i",{className:"iconfont icon-icon-73 margin05-r"}),Object(r.jsx)("span",{style:{wordBreak:"keep-all"},className:"width04 inline-block",children:"\u8bc4\u8bba"})]}),Object(r.jsxs)("span",{onClick:this.handleGoodClick,children:[Object(r.jsx)("i",{className:"".concat(n?"":"none"," iconfont margin05-r icon-icon-43")}),Object(r.jsx)("i",{className:"".concat(n?"none":""," iconfont margin05-r icon-icon-42")}),Object(r.jsx)("span",{className:"width04 inline-block",children:o})]})]})]}),Object(r.jsx)(j.a,{isPopup:c,popout:this.isShowPopup,children:Object(r.jsxs)("div",{className:"bg popup-content padding1",children:[Object(r.jsxs)("div",{className:"popup-content-header flex",children:[Object(r.jsx)("span",{onClick:this.isShowPopup,className:"popup-content-header-cancel",children:"\u53d6\u6d88"}),Object(r.jsx)("span",{className:"font3 font-bold",children:"\u8bc4\u8bba"}),Object(r.jsx)("span",{onClick:this.handleSendClick,className:"font-blue",children:"\u53d1\u9001"})]}),Object(r.jsx)("div",{children:Object(r.jsx)("textarea",{ref:function(e){return t.textarea=e},name:"common",id:"common",cols:"30",rows:"10",placeholder:"\u8bf7\u8f93\u5165\u60a8\u8bc4\u8bba\u7684\u5185\u5bb9~"})})]})})]})}}]),n}(u.Component)),x=Object(h.b)((function(t){return{app_user:t.user}}))(g),S=(n(166),function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))).state={commonList:[],activeId:0},t.computedResponseCommon=function(e){var n=t.state.commonList,o=Object(b.a)(n);if(o.push(e),t.setState({commonList:o}),e.replyComm.length>0){var r,c=Object(v.a)(e.replyComm);try{for(c.s();!(r=c.n()).done;){var i=r.value;console.log("\u5f00\u59cb\u8ba1\u7b97"),t.computedResponseCommon(i)}}catch(s){c.e(s)}finally{c.f()}}},t.updateCommonList=function(e){var n=t.state.commonList;t.setState({commonList:[].concat(Object(b.a)(n),[e])}),t.setState({activeId:e._id}),t.secComm.scrollTo(0,t.secComm.clientHeight)},t}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var t=this;Object(m.m)(this.props.common_id).then((function(e){t.computedResponseCommon(e.data)}))}},{key:"render",value:function(){var t=this;console.log("\u4f20\u8fdb\u6765\u7684id",this.props.common_id);var e=this.state,n=e.commonList,c=e.activeId;return Object(r.jsx)("div",{ref:function(e){return t.secComm=e},className:"scd-ctn bg",children:n.length>0&&n.map((function(e){return Object(r.jsx)(x,Object(o.a)(Object(o.a)({className:e._id==c?"active-animate":""},e),{},{updateCommonList:t.updateCommonList}),e._id)}))})}}]),n}(u.Component)),w=(n(167),function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))).state={secondCommon:!0,isPopup:t.props.isPopup,commonIsPopup:!1,commonList:t.props.commonList,common_id:0},t.handleSecCommonClick=function(e,n){e.stopPropagation(),t.setState({common_id:n}),t.isShowCommonPopup(e)},t.updateCommonList=function(e){var n=t.state.commonList;t.setState({commonList:[e].concat(Object(b.a)(n))})},t.isShowPopup=function(e){e.stopPropagation();var n=t.state.isPopup;t.setState({isPopup:!n})},t.isShowCommonPopup=function(e){e.stopPropagation();var n=t.state.commonIsPopup;t.setState({commonIsPopup:!n})},t.addSecondCommon=function(e){var n=t.state.commonList.map((function(t){if(t._id===e.dynamic.content.parent){var n=t.secCommonList;return t.secCommonList.length>0?t.secCommonList=[e].concat(Object(b.a)(n)).slice(0,3):t.secCommonList.push(e),t}return t}));t.setState({commonList:n})},t}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.getIsShowPopup&&this.props.getIsShowPopup(this.isShowPopup)}},{key:"render",value:function(){var t=this,e=this.state,n=e.isPopup,c=e.commonList,i=e.commonIsPopup,s=e.common_id;return Object(r.jsxs)(u.Fragment,{children:[Object(r.jsxs)("div",{children:[c&&c.length>0?c.map((function(e){return Object(r.jsx)(d.a,Object(o.a)(Object(o.a)({addSecondCommon:t.addSecondCommon,isDetail:!0,isCommon:!0,notShowUser:!0},e),{},{children:Object(r.jsxs)("div",{className:"flex",children:[Object(r.jsx)("div",{className:"margin1-r",children:Object(r.jsx)(p.a,{size:"mini",url:e.user.avatar,_id:e.user._id})}),Object(r.jsxs)("div",{className:"flex flex1 flex-column",children:[Object(r.jsxs)("div",{className:"common-header flex",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"font25",children:e&&e.user.username}),Object(r.jsx)("div",{className:"font-gray",children:e&&e.dynamic.content.updatedAt})]}),Object(r.jsx)("i",{className:"iconfont icon-icon-47",onClick:t.isShowPopup})]}),Object(r.jsxs)("div",{onClick:function(n){return t.handleSecCommonClick(n,e._id)},className:"common-content margin1-t",children:[Object(r.jsx)("span",{children:e.dynamic.content.text}),e&&e.secCommonList&&e.secCommonList.slice(0,2).map((function(t){return Object(r.jsx)(C,Object(o.a)({},t),t._id)}))]})]})]})}),e._id)})):Object(r.jsx)("span",{className:"padding1 font25 flex-center",children:"\u8bc4\u8bba\u533a\u7a7a\u7a7a\u7684\uff0c\u70b9\u51fb\u4e0b\u65b9\u6dfb\u52a0\u8bc4\u8bba\u5427"}),Object(r.jsx)(j.a,{isPopup:n,popout:this.isShowPopup,children:Object(r.jsxs)("div",{className:"padding1 transparent",children:[Object(r.jsx)(O.a,{className:"bg-gray radius-mini font25 margin1-t",onClick:this.isShowPopup,children:"\u4e3e\u62a5"}),Object(r.jsx)(O.a,{onClick:this.isShowPopup,className:"margin1-t radius-mini font25 font-bold",children:"\u53d6\u6d88"})]})}),Object(r.jsx)(j.a,{isPopup:i,popout:this.isShowCommonPopup,children:0!==s&&Object(r.jsx)(S,{common_id:s})})]}),Object(r.jsx)(y.a,{dynamic_id:this.props.dynamic_id,update:this.updateCommonList})]})}}]),n}(u.Component)),P=Object(h.b)((function(t){return{app_user:t.user}}))(w),C=function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var t=this.props,e=t.dynamic,n=t.user;return Object(r.jsxs)("div",{className:"margin1-t second-common padding1 flex bg-gray",children:[Object(r.jsx)("a",{className:"font-blue",children:n.username}),Object(r.jsxs)("span",{children:[": ",e.content.text]})]})}}]),n}(u.Component),N=(n(168),function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))).state={dynamicDetail:{},user:{}},t.getDynamicDetail=function(){Object(m.p)(t.props.match.params.id).then((function(e){t.setState({dynamicDetail:e.data}),t.setState({user:e.data.user})}))},t.getIsShowPopup=function(e){t.isShowPopup=e},t.handleMoreClick=function(e){t.isShowPopup(e)},t}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.getDynamicDetail()}},{key:"render",value:function(){var t=this.state.dynamicDetail,e=t.dynamic,n=t.commonList,c=this.state.user;return Object(r.jsxs)("div",{className:"router-view",children:[Object(r.jsx)(l.a,{centerSlot:Object(r.jsxs)("div",{className:"nav-user-info flex",children:[Object(r.jsx)(p.a,{className:"margin05-r",size:"mini",url:c.avatar,_id:c._id},Object(f.a)()),Object(r.jsx)("span",{children:c.username})]}),rightSlot:Object(r.jsx)("i",{className:"iconfont icon-icon-47",onClick:this.handleMoreClick})}),Object(r.jsx)("div",{className:"bg padding1-lr",children:e&&Object(r.jsx)(d.a,Object(o.a)(Object(o.a)({isDetail:!0,notShowUser:!0},e),{},{children:Object(r.jsx)("div",{className:"font-deep-gray margin1-t",children:e.content.updatedAt})}))}),Object(r.jsxs)("div",{className:"padding1 font-deep-gray",children:["\u5171 ",e&&e.commonNum," \u6761\u8bc4\u8bba"]}),Object(r.jsx)("div",{className:"padding1-lr bg",children:e&&Object(r.jsx)(P,{dynamic_id:e._id,commonList:n,getIsShowPopup:this.getIsShowPopup})})]})}}]),n}(u.Component))},50:function(t,e,n){"use strict";var o=n(1),r=n(8),c=n(9),i=n(11),s=n(10),a=n(0),u=n(3),l=(n(51),function(t){Object(i.a)(n,t);var e=Object(s.a)(n);function n(){var t;Object(r.a)(this,n);for(var o=arguments.length,c=new Array(o),i=0;i<o;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).state={height:0},t}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this.navbar.clientHeight;this.setState({height:t}),this.props.getHeight&&this.props.getHeight(t)}},{key:"render",value:function(){var t=this;return console.log("this.props.style",this.props.style),Object(o.jsxs)("div",{ref:function(e){return t.navbar=e},style:this.props.style||{backgroundColor:this.props.bgColor||"#FFF",top:0},className:"navbar-container padding1 flex ".concat(this.props.className," ").concat(this.props.noSticky||"sticky"),children:[Object(o.jsx)("div",{children:"boolean"===typeof this.props.leftSlot||this.props.leftSlot||Object(o.jsx)("i",{className:"iconfont icon-icon-63 line-center",style:{color:this.props.color},onClick:function(){return t.props.history.goBack()}})}),Object(o.jsx)("div",{className:"flex1 text-center margin1-lr",children:this.props.centerSlot||Object(o.jsx)("span",{className:"font3 font-bold",style:{color:this.props.color},children:this.props.title})}),Object(o.jsx)("div",{className:"navbar-container-right",children:this.props.rightSlot||""})]})}}]),n}(a.Component));e.a=Object(u.o)(l)},51:function(t,e,n){},52:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n(54);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},54:function(t,e,n){"use strict";function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return o}))},55:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var o=n(1),r=n(8),c=n(9),i=n(11),s=n(10),a=n(0),u=(n(56),function(t){Object(i.a)(n,t);var e=Object(s.a)(n);function n(){var t;Object(r.a)(this,n);for(var o=arguments.length,c=new Array(o),i=0;i<o;i++)c[i]=arguments[i];return(t=e.call.apply(e,[this].concat(c))).handleClick=function(e){if(e.stopPropagation(),"useless"===t.props.type)return!1;t.props.onClick(e)},t}return Object(c.a)(n,[{key:"render",value:function(){return Object(o.jsx)("div",{onClick:this.handleClick,style:this.props.style,className:"my-button ".concat(this.props.type||"default"," ").concat(this.props.className),children:this.props.title||this.props.children})}}]),n}(a.Component))},56:function(t,e,n){},57:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},58:function(t,e,n){(function(t){!function(n,o){"use strict";var r={};n.PubSub=r,function(t){var e={},n=-1,o="*";function r(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}function c(t){return function(){throw t}}function i(t,e,n){try{t(e,n)}catch(o){setTimeout(c(o),0)}}function s(t,e,n){t(e,n)}function a(t,n,o,r){var c,a=e[n],u=r?s:i;if(Object.prototype.hasOwnProperty.call(e,n))for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&u(a[c],t,o)}function u(t,e,n){return function(){var r=String(t),c=r.lastIndexOf(".");for(a(t,t,e,n);-1!==c;)c=(r=r.substr(0,c)).lastIndexOf("."),a(t,r,e,n);a(t,o,e,n)}}function l(t){var n=String(t);return Boolean(Object.prototype.hasOwnProperty.call(e,n)&&r(e[n]))}function p(t){for(var e=String(t),n=l(e)||l(o),r=e.lastIndexOf(".");!n&&-1!==r;)r=(e=e.substr(0,r)).lastIndexOf("."),n=l(e);return n}function d(t,e,n,o){var r=u(t="symbol"===typeof t?t.toString():t,e,o);return!!p(t)&&(!0===n?r():setTimeout(r,0),!0)}t.publish=function(e,n){return d(e,n,!1,t.immediateExceptions)},t.publishSync=function(e,n){return d(e,n,!0,t.immediateExceptions)},t.subscribe=function(t,o){if("function"!==typeof o)return!1;t="symbol"===typeof t?t.toString():t,Object.prototype.hasOwnProperty.call(e,t)||(e[t]={});var r="uid_"+String(++n);return e[t][r]=o,r},t.subscribeAll=function(e){return t.subscribe(o,e)},t.subscribeOnce=function(e,n){var o=t.subscribe(e,(function(){t.unsubscribe(o),n.apply(this,arguments)}));return t},t.clearAllSubscriptions=function(){e={}},t.clearSubscriptions=function(t){var n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&0===n.indexOf(t)&&delete e[n]},t.countSubscriptions=function(t){var n,o=0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&0===n.indexOf(t)&&o++;return o},t.getSubscriptions=function(t){var n,o=[];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&0===n.indexOf(t)&&o.push(n);return o},t.unsubscribe=function(n){var o,r,c,i=function(t){var n;for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&0===n.indexOf(t))return!0;return!1},s="string"===typeof n&&(Object.prototype.hasOwnProperty.call(e,n)||i(n)),a=!s&&"string"===typeof n,u="function"===typeof n,l=!1;if(!s){for(o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(r=e[o],a&&r[n]){delete r[n],l=n;break}if(u)for(c in r)Object.prototype.hasOwnProperty.call(r,c)&&r[c]===n&&(delete r[c],l=!0)}return l}t.clearSubscriptions(n)}}(r),void 0!==t&&t.exports&&(e=t.exports=r),e.PubSub=r,t.exports=e=r}("object"===typeof window&&window||this)}).call(this,n(57)(t))},59:function(t,e,n){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n.d(e,"a",(function(){return o}))},62:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(59);function r(t,e){if(t){if("string"===typeof t)return Object(o.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(o.a)(t,e):void 0}}},66:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n(59);var r=n(62);function c(t){return function(t){if(Array.isArray(t))return Object(o.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},69:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var o=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,e="",n=crypto.getRandomValues(new Uint8Array(t));t--;){var o=63&n[t];e+=o<36?o.toString(36):o<62?(o-26).toString(36).toUpperCase():o<63?"_":"-"}return e}}}]);
//# sourceMappingURL=9.9d3c67c9.chunk.js.map